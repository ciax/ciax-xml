<?xml version="1.0" encoding="utf-8"?>
<cdb xsi:schemaLocation="http://ciax.sum.naoj.org/ciax-xml/schema/cdb.xsd" xmlns="http://ciax.sum.naoj.org/ciax-xml/cdb" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <class frame="slo" id="mma" label="MOIRCS Arm">
    <commands xmlns="http://ciax.sum.naoj.org/ciax-xml/cdbc">
      <session id="upd" label="Update Status">
        <statement command="getstat" />
        <statement command="bs" />
        <statement command="p" />
        <repeat from="1" to="5">
          <statement command="in">
            <argv>$_</argv>
          </statement>
        </repeat>
      </session>
      <session id="reset" label="Reset">
        <statement command="reset" />
      </session>
      <session id="defcon" label="Default Config">
        <statement command="hl">
          <argv>1</argv>
        </statement>
        <statement command="e1">
          <argv>0</argv>
        </statement>
        <statement command="e2">
          <argv>0</argv>
        </statement>
      </session>
      <session id="set0" label="Set 0 Pulses">
        <statement command="set0" />
      </session>
      <session id="gf" label="Goto Focal Position">
        <statement command="ma">
          <argv>12.8</argv>
        </statement>
      </session>
      <session id="gr" label="Goto Rotate Position">
        <statement command="ma">
          <argv>123</argv>
        </statement>
      </session>
      <session id="gw" label="Goto Waiting Position">
        <statement command="ma">
          <argv>185</argv>
        </statement>
      </session>
      <session id="gs" label="Goto Stock Position">
        <statement command="ma">
          <argv>jp</argv>
        </statement>
      </session>
      <session id="sets" label="Set Stock Pos Pulse">
        <statement command="setp">
          <argv>200.44</argv>
        </statement>
      </session>
      <session id="rini" label="Init to RP at AV">
        <statement command="e2">
          <argv>1</argv>
        </statement>
        <statement command="mhn"></statement>
      </session>
      <session id="setr" label="Set Rotate Pos Pulse">
        <statement command="setp">
          <argv>123</argv>
        </statement>
      </session>
    </commands>
    <status xmlns="http://ciax.sum.naoj.org/ciax-xml/cdbs">
      <row label="Group">
        <value id="bs" label="Moter Moving" symbol="warn">
          <string ref="bs" />
        </value>
        <value id="con" label="Contact Sensor" symbol="normal">
          <string ref="in:4" />
        </value>
        <value id="err" label="Error Code" symbol="err">
          <int ref="err" />
        </value>
      </row>
      <row label="Group">
        <value id="pos" label="Arm Position" symbol="pos">
          <string ref="in:0" />
          <string ref="in:1" />
          <string ref="in:2" />
          <string ref="in:3" />
        </value>
        <value id="abs" label="ABS position" symbol="abs">
          <float ref="p" />
        </value>
      </row>
    </status>
    <watch xmlns="http://ciax.sum.naoj.org/ciax-xml/wdb" interval="1">
      <periodic period="300">
        <statement command="getstat" />
        <statement command="bs" />
        <statement command="p" />
      </periodic>
      <while ref="bs" val="1" blocking="g.">
        <interrupt command="stop" />
        <statement command="p"></statement>
        <statement command="in">
          <argv>5</argv>
        </statement>
        <statement command="in">
          <argv>3</argv>
        </statement>
      </while>
      <onchange ref="bs" val="0">
        <statement command="e2">
          <argv>0</argv>
        </statement>
      </onchange>
    </watch>
    <symbol xmlns="http://ciax.sum.naoj.org/ciax-xml/sdb">
      <table id="err" type="string">
        <case class="hide" msg="No Error">0</case>
        <case class="alarm" msg="Could not burn flash successfully">1</case>
        <case class="alarm" msg="Could not download file">2</case>
        <case class="alarm" msg="Not enough memory to execute user program">3</case>
        <case class="alarm" msg="Attempt to access a non-existent array element">4</case>
        <case class="alarm" msg="Unknown Error" />
      </table>
      <table id="pos" type="string">
        <case class="normal" msg="INIT">0001</case>
        <case class="normal" msg="STOCK">0010</case>
        <case class="normal" msg="FOCUS">0100</case>
        <case class="normal" msg="ROT">1000</case>
        <case class="alarm" msg="N/A" />
      </table>
      <table id="abs" type="range">
        <case class="normal" msg="INIT">0:0.5</case>
        <case class="normal" msg="FOCUS">12.3:13.2</case>
        <case class="normal" msg="ROT">122.5:123.5</case>
        <case class="normal" msg="WAIT">184.5:185.5</case>
        <case class="normal" msg="STOCK">200:201</case>
      </table>
    </symbol>
  </class>
</cdb>