<?xml version="1.0" encoding="utf-8"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml/mdb">
  <macro id="turret" version="0" label="Turret Control" port="55555">
    <group id="tr_main" caption="Turret Commands" column="2">
      <item id="gh_wheel" label="Go to Home Position">
        <goal label="All Home?" verify="true">
          <match form="msg" site="mft" var="v1">HOME</match>
          <match form="msg" site="mft" var="v2">HOME</match>
          <match form="msg" site="mft" var="v3">HOME</match>
          <match form="msg" site="mft" var="v4">HOME</match>
          <match form="msg" site="mft" var="v5">HOME</match>
          <match form="msg" site="mft" var="v6">HOME</match>
        </goal>
        <exec site="mix" name="posinit"/>
        <wait retry="20" label="Start?">
          <not form="msg" var="stp" site="mix">STOP</not>
        </wait>
        <wait retry="300" label="Run end?">
          <equal form="msg" var="stp" site="mix">STOP</equal>
        </wait>
        <upd site="mft"/>
      </item>
      <item id="tinit" label="Initialize Turret">
        <cfg site="mft" name="set6v"/>
        <upd site="mft"/>
        <upd site="mix"/>
        <mcr name="gh_wheel" retry="3"/>
        <cfg site="mix" name="resetp"/>
      </item>
    </group>
  </macro>
</mdb>
