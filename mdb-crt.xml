<?xml version="1.0" encoding="iso-8859-1"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://ciax.sum.naoj.org/ciax-xml/schema/mdb.xsd">
  <macro_group id="crt" class="crt" label="Cart Macro">
    <macro id="runf" label="Run Forward to Tag">
      <break label="On Tag?">
        <item stat="cpos" field="val">^0</item>
      </break>
      <check label="Ready?">
        <item stat="rdy" field="val">1</item>
      </check>
      <session>set_fwd</session>
      <session>start_run</session>
      <wait timeout="1" update="upd_all">
        <break>
          <item stat="run" field="val">1</item>
        </break>
      </wait>
      <session>clear_trg</session>
      <wait timeout="40" abort="pause" update="upd_all">
        <break>
          <item stat="run" field="val">0</item>
        </break>
      </wait>
      <check>
        <item stat="cpos" field="val">^0</item>
      </check>
    </macro>
    <macro id="run1" label="Run to Tag 1">
      <break label="On Tag1 ?">
        <item stat="cpos" field="val">1</item>
      </break>
      <check label="Ready?">
        <item stat="rdy" field="val">1</item>
      </check>
      <session>set_tag1</session>
      <session>start_run</session>
      <wait label="Start Run?" timeout="1" update="upd_all">
        <break>
          <item stat="run_start" field="val">1</item>
        </break>
      </wait>
      <session>clear_trg</session>
      <wait label="Running" timeout="40" abort="pause" update="upd_all">
        <break>
          <item stat="running" field="val">0</item>
        </break>
      </wait>
      <check label="On Tag1 ?">
        <item stat="cpos" field="val">1</item>
      </check>
    </macro>
    <macro id="jak1" label="Jack UP Level 1">
      <break label="On Level 1?">
        <item stat="jpos" field="val">1</item>
      </break>
      <check label="Ready?">
        <item stat="rdy" field="val">1</item>
      </check>
      <session>set_jak1</session>
      <session>start_jak</session>
      <wait label="Start Jak?" timeout="1" update="upd_all">
        <break>
          <item stat="jak_start" field="val">1</item>
        </break>
      </wait>
      <session>clear_trg</session>
      <wait label="Jacking" timeout="40" abort="pause" update="upd_all">
        <break>
          <item stat="jaking" field="val">0</item>
        </break>
      </wait>
      <check label="On Level 1?">
        <item stat="jpos" field="val">1</item>
      </check>
    </macro>
    <macro id="runto" label="Run to Tag" argc="1">
      <break label="On Tag?">
        <item stat="cpos" field="val" ref="par"></item>
      </break>
      <check label="Ready?">
        <item stat="rdy" field="val">1</item>
      </check>
      <session>set_tag1</session>
      <session>start_run</session>
      <wait label="Start Run?" timeout="1" update="upd_all">
        <break>
          <item stat="run_start" field="val">1</item>
        </break>
      </wait>
      <session>clear_trg</session>
      <wait label="Running" timeout="40" abort="pause" update="upd_all">
        <break>
          <item stat="running" field="val">0</item>
        </break>
      </wait>
      <check label="On Tag1 ?">
        <item stat="cpos" field="val">1</item>
      </check>
    </macro>
  </macro_group>
</mdb>