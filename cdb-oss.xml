<?xml version="1.0" encoding="iso-8859-1"?>
<cdb xsi:schemaLocation="http://ciax.sum.naoj.org/ciax-xml/schema/cdb.xsd" xmlns="http://ciax.sum.naoj.org/ciax-xml/cdb" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <class device="oss" id="oss" label="TSC Control">
    <commands>
      <session id="upd" label="Update Status">
        <statement format="logstat" />
        <statement format="getstat" />
        <statement format="iststat" />
        <statement format="jakstat" />
        <statement format="inrstat" />
      </session>
      <session id="login" label="Login">
        <statement format="login"></statement>
        <statement format="logstat"></statement>
      </session>
      <session id="logout" label="Logout">
        <statement format="logout"></statement>
        <statement format="logstat"></statement>
      </session>
      <session id="init" label="Start TCP Status Request">
        <statement format="init" />
      </session>
      <session id="startup" label="Start Up CIAX operation">
        <statement format="login" />
        <statement label="TSC Only Mode(CIAX Mode)" format="tsconly" />
        <statement format="ron" />
        <statement format="jon" />
      </session>
      <session id="shutdown" label="Shutdown CIAX operation">
        <statement format="joff" />
        <statement format="roff" />
        <statement format="tscpri" label="TSC Primaly Mode" />
        <statement format="logout" />
      </session>
      <session id="rhook" label="InR Hook">
        <statement format="rhook" />
        <statement format="inrstat" />
      </session>
      <session id="runhk" label="InR UnHook">
        <statement format="runhk" />
        <statement format="inrstat" />
      </session>
      <session id="rstop" label="InR Stop">
        <statement format="rstop" />
        <statement format="inrstat" />
      </session>
      <session id="jup" label="All EJB Up">
        <statement format="ajup" />
        <statement format="jakstat" />
      </session>
      <session id="jdw" label="All EJB Down">
        <statement format="ajdw" />
        <statement format="jakstat" />
      </session>
      <session id="jstop" label="All EJB Stop">
        <statement format="jstop" />
        <statement format="jakstat" />
      </session>
      <session id="moircs" label="Set IID MOIRCS">
        <statement format="setinst 12" />
        <statement format="iststat" />
      </session>
      <session id="focas" label="Set IID FOCAS">
        <statement format="setinst 5" />
        <statement format="iststat" />
      </session>
      <session id="comics" label="Set IID COMICS">
        <statement format="setinst 7" />
        <statement format="iststat" />
      </session>
      <session id="upj">
        <!--Update Jack Status-->
        <statement format="jakstat" />
        <statement format="getexit" />
        <statement format="getpid" />
      </session>
      <session id="upr">
        <!--Update InR Status-->
        <statement format="inrstat" />
        <statement format="getexit" />
        <statement format="getpid" />
      </session>
    </commands>
    <watch interval="1">
      <event blocking="jup|jdw" interrupt="jstop" label="Moving Jack">
        <onchange ref="jk1" />
        <command>upj</command>
      </event>
      <event blocking="rhook|runhk" interrupt="rstop" label="Moving InR">
        <onchange ref="iang" />
        <command>upr</command>
      </event>
    </watch>
    <status>
      <value format="%d" id="exit" label="Exit Code">
        <int ref="exit" />
      </value>
      <value format="%d" id="rts" label="ROT SEL" symbol="rsel">
        <int ref="rsel" />
      </value>
      <value format="%d" id="iid" label="CAS INST ID" symbol="inst">
        <int ref="iid" />
      </value>
      <value format="%s%s%s%s" id="login" label="Login Status" symbol="login">
        <string ref="login0" />
        <string ref="login1" />
        <string ref="login2" />
        <string ref="login3" />
      </value>
      <value format="%d" id="rpw" label="ROT DRIVE" symbol="rpw">
        <int ref="rpw" />
      </value>
      <value format="%s" id="jpw" label="JAK DRIVE">
        <binary bit="7" ref="bstat" />
      </value>
      <value format="%s" id="nfb" label="BOLT NFB TRIP">
        <binary bit="6" ref="bstat" />
      </value>
      <value format="%s%s" id="rps" label="ROT POS SENSOR" symbol="rps">
        <binary bit="4" ref="bstat" />
        <binary bit="5" ref="bstat" />
      </value>
      <value format="%s" id="stw" label="EL STOW">
        <binary bit="2" ref="stow_1" />
      </value>
      <value format="%s" id="stp" label="EL 90 STOW">
        <binary bit="0" ref="stow_1" />
      </value>
      <value format="%f" id="iang" label="InR Angle">
        <float ref="iang" />
      </value>
      <repeat from="0" to="15">
        <value format="%d" id="jk$_" label="Jack Pulse $_">
          <int ref="jk:$_" />
        </value>
      </repeat>
    </status>
    <symbol>
      <enum id="rsel">
        <case class="warn" val="1">PFO</case>
        <case class="warn" val="2">PFI</case>
        <case class="normal" val="4">CAS</case>
        <case class="warn" val="8">NSO</case>
        <case class="warn" val="10">NSI</case>
        <case class="alarm" val=".">N/A</case>
      </enum>
      <enum id="inst">
        <case class="warn" val="0">NONE</case>
        <case class="normal" val="1">IRCS</case>
        <case class="normal" val="3">CIAO</case>
        <case class="normal" val="5">FOCAS</case>
        <case class="normal" val="7">COMICS</case>
        <case class="normal" val="10">K3D</case>
        <case class="normal" val="12">MOIRCS</case>
        <case class="normal" val="13">CIAX3</case>
        <case class="normal" val=".">N/A</case>
      </enum>
      <regexp id="login">
        <case class="alarm" val="OSS">OSS Login</case>
        <case class="normal" val="CXWS">LOGIN</case>
        <case class="warn" val=".">LOGOUT</case>
      </regexp>
      <enum id="rpw">
        <case class="warn" val="1">ON</case>
        <case class="normal" val="2">OFF</case>
      </enum>
      <enum id="rps">
        <case class="normal" val="11">OFF</case>
        <case class="normal" val="10">0DEG</case>
        <case class="normal" val="01">-4DEG</case>
        <case class="alarm" val=".">N/A</case>
      </enum>
    </symbol>
  </class>
</cdb>