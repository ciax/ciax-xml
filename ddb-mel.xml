<?xml version='1.0' encoding='ISO-8859-1'?>
<ddb xsi:schemaLocation='http://ciax.sum.naoj.org/ciax-xml/schema/ddb.xsd' xmlns='http://ciax.sum.naoj.org/ciax-xml/ddb' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'>
  <device id='mel' label='MELSEC Q Series'>
    <cmdselect>
      <command id='chken' label='Check Enable Flag' response='chken' type='stat'>
        <data encode='lew' label='Read region command'>0x401</data>
        <data encode='lew' label='Read region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x20</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
      </command>
      <command id='getstat' label='Get all status' response='getstat' type='stat'>
        <data encode='lew' label='Read region command'>0x401</data>
        <data encode='lew' label='Read region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>52</data>
      </command>
      <command id='set_tag' label='Set Tag to Run [1-12,98,99]' response='cmdrsp' type='config'>
        <parameters label='[1-12,98,99]'>
          <par label='Data'>
            <range>1:12</range>
            <range>98</range>
            <range>99</range>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x101</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
        <eval encode='lew'>$1</eval>
      </command>
      <command id='set_pos' label='Set Pos to Jack [1-5]' response='cmdrsp' type='config'>
        <parameters label='[1-5]'>
          <par label='Data'>
            <range>1:5</range>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x103</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
        <eval encode='lew'>1 &lt;&lt; ($1-1)</eval>
      </command>
      <command id='start' label='Start Trigger [b0=run,b8=jak,b15=chg]' response='cmdrsp' type='action'>
        <parameters label='[1,256,32768]'>
          <par label='Data'>
            <range>1</range>
            <range>256</range>
            <range>32768</range>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x102</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
        <eval encode='lew'>$1</eval>
      </command>
      <command id='stop' label='Stop Trigger [b0=pause,emg,,chg,cancel,reset,mater,cycle]' response='cmdrsp' type='action'>
        <parameters label='[0-7]'>
          <par label='Data'>
            <range>0:7</range>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x100</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
        <eval encode='lew'>1 &lt;&lt; ($1-1)</eval>
      </command>
      <command id='clear' label='Clear Action Flags' response='cmdrsp' type='config'>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x100</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>4</data>
        <data encode='lew' label='Data'>0</data>
        <data encode='lew' label='Data'>0</data>
        <data encode='lew' label='Data'>0</data>
        <data encode='lew' label='Data'>0</data>
      </command>
      <command id='get_tbl' label='Get Jack Table [Tag=0-5] [JK=0-3]' response='get_tbl' type='stat'>
        <parameters label='[0-5] [0-3]'>
          <par label='Tag 0=Tag1,1=Tag9,2=Tag10,3=Tag11,4=Tag12,5=Opsm'>
            <range>0:5</range>
          </par>
          <par label='Jack 0=JK1,4=JK2,8=JK3,12=JK4'>
            <range>0:3</range>
          </par>
        </parameters>
        <data encode='lew' label='Read region command'>0x401</data>
        <data encode='lew' label='Read region subcommand'>0</data>
        <eval encode='chr' label='Jack Num'>$2 * 4</eval>
        <eval encode='chr' label='Tag Num'>$1 + 2</eval>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>0x2ch</data>
      </command>
      <command id='set_tbl' label='Set Jack Table [Tag=0-5] [JK=0-3] n,n,n..(44)' response='cmdrsp' type='config'>
        <parameters label='[0-5] [0-3] [n,n,n,...(44)]'>
          <par label='Tag 0=Tag1,1=Tag9,2=Tag10,3=Tag11,4=Tag12,5=Opsm'>
            <range>0:5</range>
          </par>
          <par label='Jack 0=JK1,4=JK2,8=JK3,12=JK4'>
            <range>0:3</range>
          </par>
          <par label='Pulses n,n,n,n...(44)'>
            <regexp>([\d]+,){43}[\d]+</regexp>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <eval encode='chr' label='Jack Num'>$2 * 4</eval>
        <eval encode='chr' label='Tag Num'>$1 + 2</eval>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>0x2ch</data>
        <eval encode='lew'>$3</eval>
      </command>
      <command id='rw_tbl' label='Read/Write Jack Table [1=Read,2=Write]' response='cmdrsp' type='config'>
        <parameters label='[1,2]'>
          <par label='Data'>
            <range>0:2</range>
          </par>
        </parameters>
        <data encode='lew' label='Write region command'>0x1401</data>
        <data encode='lew' label='Write region subcommand'>0</data>
        <data encode='lew' label='Start Address'>0x7ff</data>
        <data encode='lew' label='Device Code'>0xB400</data>
        <data encode='lew' label='Data Length'>1</data>
        <eval encode='lew' label='Parameter'>$1</eval>
      </command>
    </cmdselect>
    <cmdccrange method='len'>
      <data encode='lew' label='Q Header: CPU Watch Timer'>1</data>
      <selected/>
    </cmdccrange>
    <cmdframe>
      <data encode='lew' label='SubHeader: Prefix'>0x54</data>
      <data label='SubHeader: Serial Number'>XX</data>
      <data encode='lew' label='SubHeader: Fixed Number'>0</data>
      <data encode='chr' label='Q Header: Network Number'>0</data>
      <data encode='chr' label='Q Header: PC Number'>0xFF</data>
      <data encode='lew' label='Q Header: Request Unit I/O Number'>0x3FF</data>
      <data encode='chr' label='Q Header: Request Unit Station Number'>0</data>
      <eval encode='chr' label='Q Header: Send Data Length MSB'>${cc}</eval>
      <data encode='chr' label='Q Header: Send Data Length LSB'>0</data>
      <ccrange/>
    </cmdframe>
    <rspselect>
      <response id='chken'>
        <field decode='lew' length='2'>
          
          <assign>cre</assign>
        </field>
      </response>
      <response id='getstat'>
        <array decode='lew' length='2'>
          
          <assign>x</assign>
          <index>0:51</index>
        </array>
      </response>
      <response id='cmdrsp' label='command resp'/>
      <response id='get_tbl'>
        <array decode='lew' length='2'>
          
          <assign>t</assign>
          <index>$1</index>
          <index>$2</index>
          <index>0:43</index>
        </array>
      </response>
    </rspselect>
    <rspccrange method='len'>
      <field decode='lew' length='2'>
        
        <assign>ecode</assign>
        <verify>0</verify>
      </field>
      <selected/>
    </rspccrange>
    <rspframe>
      <field decode='lew' label='SubHeader: Prefix' length='2'>
        
        <verify>212</verify>
      </field>
      <field label='SubHeader: Serial Number' length='2'>
        
        <verify>XX</verify>
      </field>
      <field decode='lew' label='SubHeader: Fixed Number' length='2'>
        
        <verify>0</verify>
      </field>
      <field decode='chr' label='Q Header: Network Number' length='1'>
        
        <verify>0</verify>
      </field>
      <field decode='chr' label='Q Header: PC Number' length='1'>
        
        <verify>255</verify>
      </field>
      <field decode='lew' label='Q Header: Request Unit I/O Number' length='2'>
        
        <verify>1023</verify>
      </field>
      <field decode='chr' label='Q Header: Request Unit Station Number' length='1'>
        
        <verify>0</verify>
      </field>
      <field decode='lew' label='Response Data Length' length='2'>
        
        <assign>cc</assign>
      </field>
      <ccrange/>
    </rspframe>
  </device>
</ddb>
