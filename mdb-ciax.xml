<?xml version="1.0" encoding="utf-8"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml/mdb">
  <macro id="ciax" version="1" label="Cart Macro">
    <command id="runf" label="Run Forward to Tag">
      <break label="On Tag?">
        <stat ins="crt" ref="cpos" inv="true">0</stat>
      </break>
      <check retry="5" label="Ready?">
        <stat ref="rdy" ins="crt">ON</stat>
      </check>
      <exec ins="crt" name="runf"></exec>
      <check retry="40" label="Run end?">
        <stat ref="run" ins="crt">OFF</stat>
      </check>
      <check label="Destination?">
        <stat ref="cpos" inv="true" ins="crt">0</stat>
      </check>
    </command>
    <command id="run" label="Run to Tag [1-12]">
      <par>1:12</par>
      <break label="On Destination Tag?">
        <stat ref="cpos" ins="crt">$1</stat>
      </break>
      <check label="Ready?">
        <stat ref="rdy" ins="crt">ON</stat>
      </check>
      <exec ins="crt" name="run">
        <argv>$1</argv>
      </exec>
      <mcr name="runf" />
      <check retry="120" label="Run end?">
        <stat label="Running" ref="run" ins="crt">OFF</stat>
      </check>
      <check label="On Destination Tag ?">
        <stat ref="cpos" ins="crt">$1</stat>
      </check>
    </command>
    <command id="lift" label="Jack UP Level [1-4]">
      <par>1:4</par>
      <break label="On Destination Level?">
        <stat ref="jpos" ins="crt">$1</stat>
      </break>
      <check label="Ready?">
        <stat ref="rdy" ins="crt">ON</stat>
      </check>
      <exec ins="crt" name="lift">
        <argv>$1</argv>
      </exec>
      <check label="Jacking" retry="40">
        <stat ref="jak" ins="crt">OFF</stat>
      </check>
      <check label="On Destination Level?">
        <stat ref="jpos" ins="crt">$1</stat>
      </check>
    </command>
  </macro>
</mdb>