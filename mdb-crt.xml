<?xml version="1.0" encoding="utf-8"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml/mdb">
  <macro id="crt" app="crt" label="Cart Macro">
    <command id="runf" label="Run Forward to Tag">
      <check false="break">
        <stat label="On Tag?" ref="cpos" inv="true">0</stat>
      </check>
      <check false="exit" retry="5">
        <stat label="Ready?" ref="rdy">OK</stat>
      </check>
      <exec>
        <text>set_fwd</text>
      </exec>
      <exec>
        <text>start_run</text>
      </exec>
      <check false="exit" retry="3">
        <stat ref="run">ON</stat>
      </check>
      <exec>
        <text>clear_trg</text>
      </exec>
      <check false="exit" retry="40">
        <stat ref="run">OFF
</stat>
      </check>
      <check false="exit">
        <stat ref="cpos" inv="true">0</stat>
      </check>
    </command>
    <command id="run1" label="Run to Tag 1">
      <check false="break">
        <stat label="On Tag1 ?" ref="cpos" inv="true">1</stat>
      </check>
      <check false="exit">
        <stat label="Ready?" ref="rdy">1</stat>
      </check>
      <exec>
        <text>set_tag1</text>
      </exec>
      <exec>
        <text>start_run</text>
      </exec>
      <check false="exit" retry="3">
        <stat label="Start Run?" ref="run_start">1</stat>
      </check>
      <exec>
        <text>clear_trg</text>
      </exec>
      <check false="exit" retry="40">
        <stat label="Running" ref="running">ON</stat>
      </check>
      <check label="On Tag1 ?" false="exit">
        <stat ref="cpos">1</stat>
      </check>
    </command>
    <command id="jak1" label="Jack UP Level 1">
      <check label="On Level 1?" false="break">
        <stat ref="jpos">1</stat>
      </check>
      <check label="Ready?" false="exit">
        <stat ref="rdy">1</stat>
      </check>
      <exec>
        <text>set_jak1</text>
      </exec>
      <exec>
        <text>start_jak</text>
      </exec>
      <check label="Start Jak?" retry="3" false="exit">
        <stat ref="jak_start">1</stat>
      </check>
      <exec>
        <text>clear_trg</text>
      </exec>
      <check false="exit" label="Jacking" retry="40">
        <stat ref="jaking">0</stat>
      </check>
      <check label="On Level 1?">
        <stat ref="jpos">1</stat>
      </check>
    </command>
    <command argc="1" id="runto" label="Run to Tag">
      <check label="On Tag?" false="break">
        <stat inv="true" ref="cpos">0</stat>
      </check>
      <check label="Ready?" false="exit">
        <stat ref="rdy">1</stat>
      </check>
      <exec>
        <text>set_tag1</text>
      </exec>
      <exec>
        <text>start_run</text>
      </exec>
      <check label="Start Run?" retry="3" false="exit">
        <stat ref="run_start">1</stat>
      </check>
      <exec>
        <text>clear_trg</text>
      </exec>
      <check false="exit" label="Running" retry="40">
        <stat ref="running">0</stat>
      </check>
      <check label="On Tag1 ?" false="exit">
        <stat ref="cpos">1</stat>
      </check>
    </command>
  </macro>
</mdb>