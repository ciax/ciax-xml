<?xml version="1.0" encoding="utf-8"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml/mdb">
  <macro id="ciax" version="1" label="Cart Macro" port="55554">
    <group id="cx_main" caption="Macro Commands" column="2">
      <unit id="run" label="Cart Run">
        <item id="runf" label="Run Forward to Tag">
          <goal label="On Tag?">
            <not form="data" site="crt" var="cps">0</not>
          </goal>
          <mesg label="Clear the way?"/>
          <wait retry="5" label="Ready?">
            <equal form="msg" var="rdy" site="crt">ON</equal>
          </wait>
          <exec site="crt" name="runf"/>
          <wait retry="5" label="Run start?">
            <equal form="msg" var="run" site="crt">ON</equal>
          </wait>
          <wait retry="40" label="Run end?">
            <equal form="msg" var="run" site="crt">OFF</equal>
          </wait>
        </item>
        <item id="run" label="Run to Tag [1-12] w/o INST">
          <par_num label="1-12">1:12</par_num>
          <goal label="On Destination Tag?">
            <equal form="data" var="cps" site="crt">$1</equal>
          </goal>
          <check label="Ready?">
            <equal form="msg" var="rdy" site="crt">ON</equal>
          </check>
          <exec site="crt" name="run">
            <argv>$1</argv>
          </exec>
          <wait retry="5" label="Run start?">
            <equal form="msg" var="run" site="crt">ON</equal>
          </wait>
          <wait retry="120" label="Run end?">
            <equal form="msg" var="run" site="crt">OFF</equal>
          </wait>
        </item>
      </unit>
      <item id="lift" label="Jack UP Level [1-4]">
        <par_num>1:4</par_num>
        <goal label="On Destination Level?">
          <equal form="data" var="jlv" site="crt">$1</equal>
        </goal>
        <check label="Ready?">
          <equal form="msg" var="rdy" site="crt">ON</equal>
        </check>
        <exec site="crt" name="lift">
          <argv>$1</argv>
        </exec>
        <wait label="Jack start?" retry="5">
          <equal form="msg" var="jak" site="crt">ON</equal>
        </wait>
        <wait label="Jacking" retry="40">
          <equal form="msg" var="jak" site="crt">OFF</equal>
        </wait>
      </item>
    </group>
    <group id="g_jak" caption="Atomic Jack Bolt Commands" column="2" rank="3">
      <!--FIX.OPT Flange Jack Command-->
      <unit id="ufoj0" label="FIX.OPT Jack at 0deg">
        <item id="foju0" label="InR0 Jkup at FIX.OPT">
          <goal label="Jack DW?">
            <equal form="msg" site="dso" var="fjb">DW</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dso" var="fis">ON</equal>
            <equal form="msg" site="dso" var="fhk">HOOK</equal>
          </check>
          <exec site="dso" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fojd0" label="InR0 Jkdw at FIX.OPT">
          <goal label="Instrument ON?">
            <equal form="msg" site="dso" var="fis">ON</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dso" var="fhk">HOOK</equal>
          </check>
          <exec site="dso" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit id="ufoj4" label="FIX.OPT Jack at 4deg">
        <item id="foju4" label="InR4 Jkup at FIX.OPT">
          <goal label="Jack Up?">
            <equal form="msg" site="dso" var="fjb">UP</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dso" var="fhk">UNHK</equal>
          </check>
          <exec site="dso" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fojd4" label="InR4 Jkdw at FIX.OPT">
          <goal label="Jack Dw?">
            <equal form="msg" site="dso" var="fjb">DW</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dso" var="fhk">UNHK</equal>
          </check>
          <exec site="dso" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <!--FIX.IR Flange Jack Command-->
      <unit id="ufij0" label="FIX.IR Jack at 0deg">
        <item id="fiju0" label="InR0 Jkup at FIX.IR">
          <goal label="Jack DW?">
            <equal form="msg" site="dsi" var="fjb">DW</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dsi" var="fis">ON</equal>
            <equal form="msg" site="dsi" var="fhk">HOOK</equal>
          </check>
          <exec site="dsi" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fijd0" label="InR0 Jkdw at FIX.IR">
          <goal label="Instrument ON?">
            <equal form="msg" site="dsi" var="fis">ON</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dsi" var="fhk">HOOK</equal>
          </check>
          <exec site="dsi" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit id="ufij4" label="FIX.IR Jack at 4deg">
        <item id="fiju4" label="InR4 Jkup at FIX.IR">
          <goal label="Jack Up?">
            <equal form="msg" site="dsi" var="fjb">UP</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dsi" var="fhk">UNHK</equal>
          </check>
          <exec site="dsi" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fijd4" label="InR4 Jkdw at FIX.IR">
          <goal label="Jack Dw?">
            <equal form="msg" site="dsi" var="fjb">DW</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dsi" var="fhk">UNHK</equal>
          </check>
          <exec site="dsi" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <!--MOV.OPT Flange Jack Command-->
      <unit id="umoj0" label="MOV.OPT Jack at 0deg">
        <item id="moju0" label="InR0 Jkup at MOV.OPT">
          <goal label="Jack DW?">
            <equal form="msg" site="dso" var="mjb">DW</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dso" var="mis">ON</equal>
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
          </check>
          <exec site="dso" name="mjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="mojd0" label="InR0 Jkdw at MOV.OPT">
          <goal label="Instrument ON?">
            <equal form="msg" site="dso" var="mis">ON</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
          </check>
          <exec site="dso" name="mjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit id="umoj4" label="MOV.OPT Jack at 4deg">
        <item id="moju4" label="InR4 Jkup at MOV.OPT">
          <goal label="Jack Up?">
            <equal form="msg" site="dso" var="mjb">UP</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dso" var="mhk">UNHK</equal>
          </check>
          <exec site="dso" name="mjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="mojd4" label="InR4 Jkdw at MOV.OPT">
          <goal label="Jack Dw?">
            <equal form="msg" site="dso" var="mjb">DW</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dso" var="mhk">UNHK</equal>
          </check>
          <exec site="dso" name="mjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <!--MOV.IR Flange Jack Command-->
      <unit id="umij4" label="MOV.IR Jack at 0deg">
        <item id="miju4" label="InR4 Jkup at MOV.IR">
          <goal label="Jack Up?">
            <equal form="msg" site="dsi" var="mjb">UP</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dsi" var="mhk">UNHK</equal>
          </check>
          <exec site="dsi" name="mjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="mijd4" label="InR4 Jkdw at MOV.IR">
          <goal label="Jack Dw?">
            <equal form="msg" site="dsi" var="mjb">DW</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dsi" var="mhk">UNHK</equal>
          </check>
          <exec site="dsi" name="mjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit id="umij0" label="MOV.IR Jack at 4deg">
        <item id="miju0" label="InR0 Jkup at MOV.IR">
          <goal label="Jack DW?">
            <equal form="msg" site="dsi" var="mjb">DW</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dsi" var="mis">ON</equal>
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
          </check>
          <exec site="dsi" name="mjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="mijd0" label="InR0 Jkdw at MOV.IR">
          <goal label="Instrument ON?">
            <equal form="msg" site="dsi" var="mis">ON</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
          </check>
          <exec site="dsi" name="mjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <!--CAS Flange Jack Command-->
      <unit id="ucj0" label="CAS Jack at 0deg">
        <item id="cju0" label="InR0 Jkup at CAS">
          <goal label="Jack DW?">
            <equal form="msg" site="dts" var="bl01">DW</equal>
          </goal>
          <check label="HOOK ON?">
            <equal form="msg" site="dts" var="cis">ON</equal>
            <equal form="msg" site="dts" var="iang">HOOK</equal>
          </check>
          <exec site="dts" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="cjd0" label="InR0 Jkdw at CAS">
          <goal label="Instrument ON?">
            <equal form="msg" site="dts" var="cis">ON</equal>
          </goal>
          <check label="HOOK?">
            <equal form="msg" site="dts" var="iang">HOOK</equal>
          </check>
          <exec site="dts" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit id="ucj4" label="CAS Jack at 4deg">
        <item id="cju4" label="InR4 Jkup at CAS">
          <goal label="Jack Up?">
            <equal form="msg" site="dts" var="bl01">UP</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dts" var="iang">UNHK</equal>
          </check>
          <exec site="dts" name="fjup"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="cjd4" label="InR4 Jkdw at CAS">
          <goal label="Jack Dw?">
            <equal form="msg" site="dts" var="bl01">DW</equal>
          </goal>
          <check label="UNHOOK?">
            <equal form="msg" site="dts" var="iang">UNHK</equal>
          </check>
          <exec site="dts" name="fjdw"/>
          <wait label="Jack start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="Jacking" retry="50">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
    </group>
    <group id="g_hook" caption="Atomic Hook Commands" rank="3">
      <unit label="FIX.IR Hook" id="ufih">
        <item id="fihk" label="Hook at FIX.IR">
          <goal label="Hooked?">
            <equal form="msg" site="dsi" var="fhk">HOOK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dsi" var="fjb">DW</equal>
          </check>
          <exec site="dsi" name="fhook"/>
          <wait label="Hook start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Hooking" retry="40">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fiuh" label="UnHook at FIX.IR">
          <goal label="UnHooked?">
            <equal form="msg" site="dsi" var="fhk">UNHK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dsi" var="fjb">DW</equal>
          </check>
          <exec site="dsi" name="funhk"/>
          <wait label="UnHook start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="UnHooking" retry="40">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit label="FIX.OPT Hook" id="ufoh">
        <item id="fohk" label="Hook at FIX.OPT">
          <goal label="Hooked?">
            <equal form="msg" site="dso" var="fhk">HOOK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dso" var="fjb">DW</equal>
          </check>
          <exec site="dso" name="fhook"/>
          <wait label="Hook start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Hooking" retry="40">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="fouh" label="UnHook at FIX.OPT">
          <goal label="UnHooked?">
            <equal form="msg" site="dso" var="fhk">UNHK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dso" var="fjb">DW</equal>
          </check>
          <exec site="dso" name="funhk"/>
          <wait label="UnHook start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="UnHooking" retry="40">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit label="MOV.IR Hook" id="umih">
        <item id="mihk" label="Hook at MOV.IR">
          <goal label="Hooked?">
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dsi" var="mjb">DW</equal>
          </check>
          <exec site="dsi" name="mhook"/>
          <wait label="Hook start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Hooking" retry="40">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="miuh" label="UnHook at MOV.IR">
          <goal label="UnHooked?">
            <equal form="msg" site="dsi" var="mhk">UNHK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dsi" var="mjb">DW</equal>
          </check>
          <exec site="dsi" name="munhk"/>
          <wait label="UnHook start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="UnHooking" retry="40">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit label="MOV.OPT Hook" id="umoh">
        <item id="mohk" label="Hook at MOV.OPT">
          <goal label="Hooked?">
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dso" var="mjb">DW</equal>
          </check>
          <exec site="dso" name="mhook"/>
          <wait label="Hook start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Hooking" retry="40">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="mouh" label="UnHook at MOV.OPT">
          <goal label="UnHooked?">
            <equal form="msg" site="dso" var="mhk">UNHK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dso" var="mjb">DW</equal>
          </check>
          <exec site="dso" name="munhk"/>
          <wait label="UnHook start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="UnHooking" retry="40">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>

      <unit label="CAS Hook" id="ucsh">
        <item id="cshk" label="Hook at CAS">
          <goal label="Hooked?">
            <equal form="msg" site="dts" var="iang">HOOK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dts" var="bl01">DW</equal>
          </check>
          <exec site="dts" name="rhook"/>
          <wait label="Hook start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="Hooking" retry="40">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
        <item id="csuh" label="UnHook at CAS">
          <goal label="UnHooked?">
            <equal form="msg" site="dts" var="iang">UNHK</equal>
          </goal>
          <check label="EJB Down?">
            <equal form="msg" site="dts" var="bl01">DW</equal>
          </check>
          <exec site="dts" name="runhk"/>
          <wait label="UnHook start?" retry="5">
            <equal form="msg" site="dts" var="exe">ON</equal>
          </wait>
          <wait label="UnHooking" retry="40">
            <equal form="msg" site="dts" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>



    </group>
    <group id="g_mov" caption="Atomic Movable Flange Commands" rank="3">
      <!--MOV.OPT Transer and Rotate-->
      <unit label="MOV.OPT Rotation" id="uor">
        <item label="MOV.OPT Rotation (Load)" id="oro">
          <goal label="Rotation Stored?">
            <equal form="msg" site="dso" var="mrt">DES</equal>
          </goal>
          <check>
            <equal form="msg" site="dso" var="mrt">STR</equal>
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
            <equal form="msg" site="dso" var="mtr">FW</equal>
          </check>
          <exec site="dso" name="rotout"/>
          <wait label="Rotate start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Rotating" retry="20">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item label="MOV.OPT Rotation (Store)" id="ori">
          <goal label="Rotation Stored?">
            <equal form="msg" site="dso" var="mrt">STR</equal>
          </goal>
          <check>
            <equal form="msg" site="dso" var="mrt">DES</equal>
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
            <equal form="msg" site="dso" var="mtr">FW</equal>
          </check>
          <exec site="dso" name="rotin"/>
          <wait label="Rotate start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Rotating" retry="20">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit label="MOV.OPT Transer" id="uot">
        <item label="MOV.OPT Transer Back" id="otb">
          <goal label="Transer Stored?">
            <equal form="msg" site="dso" var="mtr">BK</equal>
          </goal>
          <check>
            <equal form="msg" site="dso" var="mrt">STR</equal>
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
            <equal form="msg" site="dso" var="mtr">FW</equal>
          </check>
          <exec site="dso" name="trin"/>
          <wait label="Transer start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Moving" retry="60">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
        <item label="MOV.OPT Transer Forth" id="otf">
          <goal label="Transer Stored?">
            <equal form="msg" site="dso" var="mtr">FW</equal>
          </goal>
          <check>
            <equal form="msg" site="dso" var="mrt">STR</equal>
            <equal form="msg" site="dso" var="mhk">HOOK</equal>
            <equal form="msg" site="dso" var="mtr">BK</equal>
          </check>
          <exec site="dso" name="trout"/>
          <wait label="Transer start?" retry="5">
            <equal form="msg" site="dso" var="exe">ON</equal>
          </wait>
          <wait label="Moving" retry="60">
            <equal form="msg" site="dso" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <!--MOV.IR Transer and Rotate-->
      <unit label="MOV.IR Rotation" id="uir">
        <item label="MOV.IR Rotation (Load)" id="iro">
          <goal label="Rotation Stored?">
            <equal form="msg" site="dsi" var="mrt">DES</equal>
          </goal>
          <check>
            <equal form="msg" site="dsi" var="mrt">STR</equal>
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
            <equal form="msg" site="dsi" var="mtr">FW</equal>
          </check>
          <exec site="dsi" name="rotout"/>
          <wait label="Rotate start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Rotating" retry="20">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item label="MOV.IR Rotation (Store)" id="iri">
          <goal label="Rotation Stored?">
            <equal form="msg" site="dsi" var="mrt">STR</equal>
          </goal>
          <check>
            <equal form="msg" site="dsi" var="mrt">DES</equal>
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
            <equal form="msg" site="dsi" var="mtr">FW</equal>
          </check>
          <exec site="dsi" name="rotin"/>
          <wait label="Rotate start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Rotating" retry="20">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
      <unit label="MOV.IR Transer" id="uit">
        <item label="MOV.IR Transer Back" id="itb">
          <goal label="Transer Stored?">
            <equal form="msg" site="dsi" var="mtr">BK</equal>
          </goal>
          <check>
            <equal form="msg" site="dsi" var="mrt">STR</equal>
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
            <equal form="msg" site="dsi" var="mtr">FW</equal>
          </check>
          <exec site="dsi" name="trin"/>
          <wait label="Transer start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Moving" retry="60">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
        <item label="MOV.IR Transer Forth" id="itf">
          <goal label="Transer Stored?">
            <equal form="msg" site="dsi" var="mtr">FW</equal>
          </goal>
          <check>
            <equal form="msg" site="dsi" var="mrt">STR</equal>
            <equal form="msg" site="dsi" var="mhk">HOOK</equal>
            <equal form="msg" site="dsi" var="mtr">BK</equal>
          </check>
          <exec site="dsi" name="trout"/>
          <wait label="Transer start?" retry="5">
            <equal form="msg" site="dsi" var="exe">ON</equal>
          </wait>
          <wait label="Moving" retry="60">
            <equal form="msg" site="dsi" var="exe">OFF</equal>
          </wait>
        </item>
      </unit>
    </group>
    <group id="g_tr" caption="Transer Commands">
      <!--Transer and Rotate-->
      <unit label="MOV.IR Rot/Transer" id="uirt">
        <item id="trsi" label="MOV.IR Trans Backward w/INST">
          <goal label="Transer Stored Position?">
            <equal form="msg" site="dsi" var="mtr">BK</equal>
          </goal>
          <check label="CART CLEAR?">
            <not form="data" site="crt" var="cps">12</not>
            <not form="data" site="crt" var="cps">11</not>
          </check>
          <mcr name="iri"/>
          <mcr name="itb"/>
        </item>
        <item id="trli" label="MOV.IR Trans Forward w/INST">
          <goal label="Transer Loading Position?">
            <equal form="msg" site="dsi" var="mtr">FW</equal>
            <equal form="msg" site="dsi" var="rot">LOAD</equal>
          </goal>
          <check label="CART CLEAR?">
            <not form="data" site="crt" var="cps">12</not>
            <not form="data" site="crt" var="cps">11</not>
          </check>
          <mcr name="itf"/>
          <mcr name="iro"/>
        </item>
      </unit>
      <unit label="MOV.OPT Rot/Transer" id="uort">
        <item id="trso" label="MOV.OPT Trans Backward w/INST">
          <goal label="Transer Stored Position?">
            <equal form="msg" site="dso" var="mtr">BK</equal>
          </goal>
          <check label="CART CLEAR?">
            <not form="data" site="crt" var="cps">10</not>
            <not form="data" site="crt" var="cps">9</not>
          </check>
          <mcr name="ori"/>
          <mcr name="otb"/>
        </item>
        <item id="trlo" label="MOV.OPT Trans Forward w/INST">
          <goal label="Transer Loading Position?">
            <equal form="msg" site="dso" var="mtr">FW</equal>
            <equal form="msg" site="dso" var="rot">LOAD</equal>
          </goal>
          <check label="CART CLEAR?">
            <not form="data" site="crt" var="cps">10</not>
            <not form="data" site="crt" var="cps">9</not>
          </check>
          <mcr name="otf"/>
          <mcr name="oro"/>
        </item>
      </unit>
    </group>
    <group id="g_fr" caption="Flange Commands">
      <!--FIX Jack & Rotate-->
      <item id="jupd" label="HookUp at FIX.IR">
        <goal label="Instrument ON?">
          <equal form="msg" site="dsi" var="fis">ON</equal>
        </goal>
        <check label="CART ON TAG?">
          <equal form="data" site="crt" var="cps">12</equal>
          <equal form="msg" site="crt" var="jlv">H</equal>
        </check>
        <mcr name="fijd4"/>

        <exec site="dsi" name="fhook"/>
        <wait label="Hook start?" retry="5">
          <equal form="msg" site="$1" var="exe">ON</equal>
        </wait>
        <wait label="Hooking" retry="40">
          <equal form="msg" site="$1" var="exe">OFF</equal>
        </wait>
        <mcr name="fju0">
          <argv>$1</argv>
        </mcr>
      </item>
    </group>
    <group id="g_run" caption="Transport Commands">
      <!--Run & Transer-->
      <item id="runi" label="Run with interlock to Tag [1-12]">
        <par_num label="1-12">1:12</par_num>
        <select form="data" site="crt" var="cps">
          <option val="8">
            <mcr name="r08to">
              <argv>$1</argv>
            </mcr>
          </option>
          <option>
            <mcr name="run">
              <argv>$1</argv>
            </mcr>
          </option>
        </select>
      </item>
      <item id="r08to" label="Leave IR from Tag 8 to [2-7]">
        <par_num>1:12</par_num>
        <goal label="Leave Cart and Transer Stored?">
          <equal form="data" site="crt" var="cps">8</equal>
        </goal>
        <check label="CART CLEAR?">
          <equal form="data" site="crt" var="cps">8</equal>
          <equal form="msg" site="crt" var="ion">OFF</equal>
        </check>
        <exec site="crt" name="run">
          <argv>$1</argv>
        </exec>
        <wait retry="5" label="Run start?">
          <equal form="msg" var="run" site="crt">ON</equal>
        </wait>
        <mcr async="true" name="trsi">
          <argv>dsi</argv>
        </mcr>
        <wait retry="120" label="Run end?">
          <equal form="msg" label="Running" site="crt" var="run">OFF</equal>
        </wait>
      </item>
    </group>
  </macro>
</mdb>
