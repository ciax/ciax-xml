<?xml version="1.0" encoding="utf-8"?>
<mdb xmlns="http://ciax.sum.naoj.org/ciax-xml/mdb">
  <macro id="mos" version="1" label="MOS Macro" port="55555">
    <group id="grp_mfp">
      <item id="mfp_ro" label="Robohand All Open">
        <goal>
          <match site="mfp" var="ro" form="msg">OPEN</match>
        </goal>
        <exec site="mfp" name="ro"/>
        <wait sleep="4"/>
      </item>
      <item id="mfp_rc" label="Robohand All Close">
        <goal>
          <match site="mfp" var="ro" form="msg">CLOSE</match>
        </goal>
        <exec site="mfp" name="rc"/>
        <wait sleep="4"/>
      </item>
      <item id="mfp_go" label="Gate Valve Open">
        <goal>
          <match site="mfp" var="gv" form="msg">OPEN</match>
        </goal>
        <exec site="mfp" name="go"/>
        <wait sleep="5"/>
      </item>
      <item id="mfp_gc" label="Gate Valve Close">
        <goal>
          <match site="mfp" var="gv" form="msg">CLOSE</match>
        </goal>
        <exec site="mfp" name="gc"/>
        <wait sleep="2"/>
      </item>
      <item id="mfp_av" label="Arm Vertical">
        <goal>
          <match site="mfp" var="hv" form="msg">Ver</match>
        </goal>
        <exec site="mfp" name="av"/>
        <wait sleep="8"/>
      </item>
      <item id="mfp_ah" label="Arm Horizontal">
        <goal>
          <match site="mfp" var="hv" form="msg">Hor</match>
        </goal>
        <exec site="mfp" name="ah"/>
        <wait sleep="8"/>
      </item>
      <item id="mfp_ao" label="Arm Open">
        <goal>
          <match site="mfp" var="ao" form="msg">OPEN</match>
        </goal>
        <exec site="mfp" name="ao"/>
        <wait sleep="3"/>
      </item>
      <item id="mfp_ac" label="Arm Close">
        <goal>
          <match site="mfp" var="ao" form="msg">CLOSE</match>
        </goal>
        <exec site="mfp" name="ac"/>
        <wait sleep="3"/>
      </item>
    </group>
    <group id="grp_mma">
      <unit id="unit_raboc" label="Robohand 1and2(a)/3and4(b) Open/Close">
        <item id="mma_set0" label="Set 0 Counter">
          <goal>
            <match site="mma" var="abs" form="msg">0.000000</match>
          </goal>
          <check>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
          </check>
          <cfg site="mma" name="set0"/>
        </item>
        <item id="mma_mres" label="Motor Reset">
          <check>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </check>
          <exec site="mma" name="mres"/>
        </item>
        <item id="mma_ini" label="Initialize Position">
          <goal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </goal>
          <exec site="mma" name="ini"/>
          <wait retry="95">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_gf" label="Go to Focal Position">
          <goal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
          </goal>
          <exec site="mma" name="gf"/>
          <wait retry="80">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_gr" label="Go to Rotate Position">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <exec site="mma" name="gr"/>
          <wait retry="60">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_gw" label="Go to Waiting Position">
          <goal>
            <match site="mma" var="abs" form="msg">WAIT</match>
          </goal>
          <exec site="mma" name="gw"/>
          <wait retry="60">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_gs" label="Go to Stock Position">
          <goal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
          </goal>
          <exec site="mma" name="gs"/>
          <wait retry="95">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_setstk" label="Initialize at Stock">
          <check>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <match site="mma" var="abs" form="msg">STOCK</match>
          </check>
          <cfg site="mma" name="setstk"/>
        </item>
        <item id="mma_rini" label="Init to RP at AV">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <exec site="mma" name="rini"/>
          <wait retry="95">
            <equal site="mma" var="bs" form="msg">0</equal>
          </wait>
        </item>
        <item id="mma_setrot" label="Set RP Pulse">
          <check>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mma" var="abs" form="msg">ROT</match>
          </check>
          <cfg site="mma" name="setrot"/>
        </item>
      </unit>
    </group>
    <group id="grp_mcr">
      <unit id="unit_sha" label="Shared Command">
        <item id="stop" label="Emergency STOP">
          <exec site="mma" name="astop"/>
          <exec site="mmc" name="astop"/>
        </item>
        <item id="upd" label="Update">
          <upd site="mma"/>
          <upd site="mmc"/>
          <upd site="mfp"/>
          <upd site="map"/>
        </item>
        <item id="chk" label="Check Status(No actual motion)">
        </item>
      </unit>
      <unit id="unit_stam" label="Sub Start Mask">
        <item id="ah_t-i" label="Arm Hor">
          <goal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ah"/>
        </item>
        <item id="ao_t-i" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="rc_t-i" label="Rh Close">
          <goal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="gf_t-f" label="Go to FCS">
          <goal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gf"/>
        </item>
        <item id="ac_t-f" label="Arm Close">
          <goal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ac"/>
        </item>
        <item id="ro_t-f" label="Rh Open">
          <goal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
        <item id="gr_t-r" label="Go to ROT">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gr"/>
        </item>
        <item id="av_t-r" label="Arm Ver">
          <goal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_av"/>
        </item>
        <item id="ao_t-r" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="gw_t-w" label="Go to WAIT">
          <goal>
            <match site="mma" var="abs" form="msg">WAIT</match>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gw"/>
        </item>
        <item id="check_start" label="Check Status(No actual motion)">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="chk"/>
        </item>
      </unit>
      <unit id="unit_stom" label="Sub Store Mask">
        <item id="ah_s-i" label="Arm Hor">
          <goal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ah"/>
        </item>
        <item id="ao_s-i" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="rc_s-i" label="Rh Close">
          <goal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="gf_s-f" label="Go to FOCUS">
          <goal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gf"/>
        </item>
        <item id="ac_s-f" label="Arm Close">
          <goal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ac"/>
        </item>
        <item id="ro_s-f" label="Rh Open">
          <goal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <equal site="mma" var="con" form="msg">ON</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
        <item id="gr_s-r" label="Go to ROT">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gr"/>
        </item>
        <item id="av_s-r" label="Arm Ver">
          <goal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_av"/>
        </item>
        <item id="gs_s-s" label="Go to STK">
          <goal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gs"/>
        </item>
        <item id="ao_s-s" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="gw_s-w" label="Go to WAIT">
          <goal>
            <match site="mma" var="abs" form="msg">WAIT</match>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="con" form="msg">OFF</equal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gw"/>
        </item>
        <item id="check_store" label="Check Status(No actual motion)">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="chk"/>
        </item>
      </unit>
      <unit id="unit_lom" label="Sub Load Mask">
        <item id="av_l-w" label="Arm Ver">
          <goal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_av"/>
        </item>
        <item id="ao_l-w" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="gs_l-s" label="Go to STK">
          <goal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gs"/>
        </item>
        <item id="ac_l-s" label="Arm Close">
          <goal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ac"/>
        </item>
        <item id="gr_l-r" label="Go to ROT">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <equal site="mma" var="con" form="msg">ON</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gr"/>
        </item>
        <item id="ah_l-r" label="Arm Hor">
          <goal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
            <equal site="mmc" var="in1" form="msg">OFF</equal>
          </check>
          <mcr name="mfp_ah"/>
        </item>
        <item id="gf_l-f" label="Go to FOCUS">
          <goal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gf"/>
        </item>
        <item id="rc_l-f" label="Rh All Close">
          <goal>
            <not site="mfp" var="rh1" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="ro_l-f" label="Rh All Open">
          <goal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
        <item id="ao_l-f" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <equal site="mma" var="con" form="msg">ON</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="ini_l-i" label="Go to INIT">
          <goal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_ini"/>
        </item>
      </unit>
      <unit id="unit_fchk" label="Sub Field Check">
        <item id="set0_a" label="Motor Reset">
          <mcr name="mma_set0"/>
        </item>
      </unit>
      <unit id="unit_lom" label="Sub Load Mask">
        <item id="setstk_a" label="Motor Reset at STK">
          <check>
            <equal site="mma" var="pos" form="msg">STOCK</equal>
            <match site="mma" var="abs" form="msg">STOCK</match>
          </check>
          <mcr name="mma_setstk"/>
        </item>
        <item id="check_load" label="Check Status(No actual motion)">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" skip="true" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="chk"/>
        </item>
      </unit>
      <unit id="unit_fchk" label="Sub Field Check">
        <item id="ah_fc-i1" label="Arm Hor">
          <goal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ah"/>
        </item>
        <item id="ao_fc-i1" label="Arm Open">
          <goal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ao"/>
        </item>
        <item id="rc_fc-i1" label="Rh All Close">
          <goal>
            <not site="mfp" var="rh1" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="gf_fc-f1" label="Go to FOCUS">
          <goal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gf"/>
        </item>
        <item id="ac_fc-f1" label="Arm Close">
          <goal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ac"/>
        </item>
        <item id="ro_fc-f1" label="Rh All Open">
          <goal>
            <equal site="mfp" var="rh1" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <not site="mfp" var="rh1" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh2" form="msg">OPEN</not>
            <not site="mfp" var="rh3" skip="true" form="msg">OPEN</not>
            <not site="mfp" var="rh4" skip="true" form="msg">OPEN</not>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <equal site="mma" var="con" form="msg">ON</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
        <item id="gr_fc-r1" label="Go to ROT">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">FOCUS</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gr"/>
        </item>
      </unit>
      <unit id="unit_kapam" label="Sub Kapa Mask">
        <item id="rc_k" label="Rh All Close">
          <goal>
            <equal site="mfp" var="ro" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="ro_k" label="Rh All Open">
          <goal>
            <equal site="mfp" var="ro" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
        <item id="rc_k1" label="Rh All Close">
          <goal>
            <equal site="mfp" var="ro" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="ro_k1" label="Rh All Open">
          <goal>
            <equal site="mfp" var="ro" form="msg">OPEN</equal>
          </goal>
          <check>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ro"/>
        </item>
      </unit>
      <unit id="unit_finm" label="Sub Fin Mask">
        <item id="gr_f-r" label="Go to ROT">
          <goal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <match site="mma" var="abs" form="msg">WAIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_gr"/>
        </item>
        <item id="ac_f-r" label="Arm Close">
          <goal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">OPEN</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ac"/>
        </item>
        <item id="ah_f-r" label="Arm Hor">
          <goal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Vertical</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_ah"/>
        </item>
        <item id="ini_f-i" label="Go to INIT">
          <goal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">ROT</equal>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mma_ini"/>
        </item>
        <item id="rc_f-i" label="Rh All Close">
          <goal>
            <equal site="mfp" var="rh1" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh2" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">CLOSE</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh2" form="msg">OPEN</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">OPEN</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">OPEN</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="mfp_rc"/>
        </item>
        <item id="check_fin" label="Check Status(No actual motion)">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <equal site="mfp" var="hv" form="msg">Horizontal</equal>
            <equal site="mfp" var="ao" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh1" skip="true" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh2" skip="true" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh3" skip="true" form="msg">CLOSE</equal>
            <equal site="mfp" var="rh4" skip="true" form="msg">CLOSE</equal>
            <equal site="mma" var="pos" form="msg">INIT</equal>
            <match site="mma" var="abs" form="msg">INIT</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <match site="map" var="pres" form="msg">OK</match>
          </check>
          <mcr name="chk"/>
        </item>
      </unit>
      <unit id="unit_main" label="MOS Main Commands">
        <item id="start" label="startmask">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="upd"/>
          <mcr name="t-w"/>
        </item>
      </unit>
      <unit id="unit_stam" label="Sub Start Mask">
        <item id="t-i" label="startmask (INIT)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="ah_t-i"/>
          <mcr name="ao_t-i"/>
          <mcr name="rc_t-i"/>
        </item>
        <item id="t-f" label="startmask (INIT~FOCUS)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="t-i"/>
          <mcr name="gf_t-f"/>
          <mcr name="ac_t-f"/>
          <upd site="mma"/>
          <mcr name="ro_t-f"/>
        </item>
        <item id="t-r" label="startmask (FOCUS~ROT)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="t-f"/>
          <mcr name="gr_t-r"/>
          <mcr name="av_t-r"/>
          <upd site="map"/>
          <mcr name="ao_t-r"/>
        </item>
        <item id="t-w" label="startmask (ROT~WAIT)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="abs" form="msg">WAIT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="t-r"/>
          <mcr name="gw_t-w"/>
          <mcr name="check_start"/>
        </item>
      </unit>
      <unit id="unit_main" label="MOS Main Commands">
        <item id="store" label="storemask">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="upd"/>
          <mcr name="s-w"/>
        </item>
      </unit>
      <unit id="unit_stom" label="Sub Store Mask">
        <item id="s-i" label="storemask 1(INIT)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="ah_s-i"/>
          <mcr name="ao_s-i"/>
          <mcr name="rc_s-i"/>
        </item>
        <item id="s-f" label="storemask 2(INIT~FOCUS)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="s-i"/>
          <mcr name="gf_s-f"/>
          <mcr name="ac_s-f"/>
          <upd site="mma"/>
          <mcr name="ro_s-f"/>
        </item>
        <item id="s-r" label="storemask 3(FOCUS~ROT)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="s-f"/>
          <mcr name="gr_s-r"/>
          <mcr name="av_s-r"/>
        </item>
        <item id="s-s" label="storemask 4(ROT~STOCK)">
          <goal>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">STOCK</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="s-r"/>
          <mcr name="gs_s-s"/>
          <upd site="map"/>
          <mcr name="setstk_a"/>
          <upd site="map"/>
          <upd site="mma"/>
          <mcr name="ao_s-s"/>
        </item>
        <item id="s-w" label="storemask 5(STOCK~WAIT)">
          <goal>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">STOCK</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="s-s"/>
          <upd site="mma"/>
          <upd site="mmc"/>
          <upd site="map"/>
          <mcr name="gw_s-w"/>
          <mcr name="check_store"/>
        </item>
      </unit>
      <unit id="unit_main" label="MOS Main Commands">
        <item id="load" label="loadmask">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="upd"/>
          <mcr name="l-i"/>
        </item>
      </unit>
      <unit id="unit_lom" label="Sub Load Mask">
        <item id="l-w" label="loadmask 1(WAIT)">
          <goal>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="av_l-w"/>
          <mcr name="ao_l-w"/>
        </item>
        <item id="l-s" label="loadmask 2(WAIT~STOCK)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">STOCK</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="l-w"/>
          <mcr name="gs_l-s"/>
          <upd site="map"/>
          <mcr name="setstk_a"/>
          <mcr name="ac_l-s"/>
        </item>
        <item id="l-r" label="loadmask 3(STOCK~ROT)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">STOCK</not>
            <not site="mma" var="pos" form="msg">ROT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="l-s"/>
          <upd site="mma"/>
          <upd site="map"/>
          <mcr name="gr_l-r"/>
          <upd site="mmc"/>
          <mcr name="ah_l-r"/>
        </item>
        <item id="l-f" label="loadmask 4(ROT~FOCUS)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">STOCK</not>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="l-r"/>
          <mcr name="gf_l-f"/>
          <mcr name="rc_l-f"/>
          <upd site="mma"/>
          <mcr name="ao_l-f"/>
        </item>
        <item id="l-mskon" label="loadmask (Mask Sensor Check)">
          <goal>
            <equal site="mma" var="con" form="msg">ON</equal>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
        </item>
        <item id="l-mskoff" label="loadmask (Mask Sensor Check)">
          <goal>
            <not site="mma" var="con" form="msg">ON</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="ro_l-f"/>
          <upd site="map"/>
          <mcr name="rc_l-f"/>
          <upd site="mma"/>
        </item>
        <item id="l-i" label="loadmask 5(FOCUS~INIT)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">STOCK</not>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">INIT</not>
            <unmatch site="mma" var="abs" form="msg">INIT</unmatch>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S </match>
          </check>
          <mcr name="l-f"/>
          <mcr name="ini_l-i"/>
          <upd site="map"/>
          <mcr name="set0_a"/>
          <mcr name="check_load"/>
        </item>
      </unit>
      <item id="fcheck">
        <check>
          <equal site="mfp" var="gv" form="msg">OPEN</equal>
          <match site="map" var="pres" form="msg">OK</match>
          <match site="mmc" var="abs" form="msg">S</match>
        </check>
      </item>
      <unit id="unit_fchk" label="Sub Field Check">
        <item id="fc-i1" label="fieldcheck (INIT)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <not site="mma" var="pos" form="msg">INIT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="ah_fc-i1"/>
          <mcr name="ao_fc-i1"/>
          <mcr name="rc_fc-i1"/>
        </item>
        <item id="fc-f1" label="fieldcheck (INIT~FOCUS)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="fc-i1"/>
          <mcr name="gf_fc-f1"/>
          <mcr name="ac_fc-f1"/>
          <upd site="mma"/>
          <mcr name="ro_fc-f1"/>
        </item>
        <item id="fc-r1" label="fieldcheck (FOCUS~ROT)">
          <goal>
            <not site="mma" var="pos" form="msg">NA</not>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <not site="mma" var="pos" form="msg">ROT</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="fc-f1"/>
          <mcr name="gr_fc-r1"/>
        </item>
      </unit>
      <unit id="unit_main" label="MOS Main Commands">
        <item id="kapa" label="align mask">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </check>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
          <upd site="map"/>
          <mcr name="ro_k"/>
          <upd site="map"/>
          <mcr name="rc_k"/>
        </item>
        <item id="kapa1" label="rail-up">
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <equal site="mma" var="pos" form="msg">INIT</equal>
          </check>
          <mcr name="ro_k1"/>
          <upd site="map"/>
          <mcr name="rc_k1"/>
        </item>
        <item id="fin" label="finish mos">
          <goal>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
          </check>
          <mcr name="upd"/>
          <mcr name="f-i"/>
        </item>
      </unit>
      <unit id="unit_finm" label="Sub Fin Mask">
        <item id="f-r" label="fin 1(WAIT~ROT)">
          <goal>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </check>
          <mcr name="gr_f-r"/>
          <mcr name="ac_f-r"/>
          <upd site="map"/>
          <mcr name="ah_f-r"/>
        </item>
        <item id="f-i" label="fin 2(ROT~INIT)">
          <goal>
            <unmatch site="mma" var="abs" form="msg">WAIT</unmatch>
            <not site="mma" var="pos" form="msg">ROT</not>
            <not site="mma" var="pos" form="msg">INIT</not>
            <not site="mma" var="pos" form="msg">FOCUS</not>
          </goal>
          <check>
            <equal site="mfp" var="gv" form="msg">OPEN</equal>
            <match site="map" var="pres" form="msg">OK</match>
            <match site="mmc" var="abs" form="msg">S</match>
            <not site="mma" var="pos" form="msg">FOCUS</not>
            <equal site="mmc" var="in1" form="msg">ON</equal>
          </check>
          <mcr name="f-r"/>
          <mcr name="ini_f-i"/>
          <upd site="map"/>
          <mcr name="set0_a"/>
          <mcr name="rc_f-i"/>
          <mcr name="check_fin"/>
        </item>
      </unit>
      <unit id="unit_lom" label="Sub Load Mask">
        <item id="rac_l-f" label="Rh1 2 Close">
          <exec site="mfp" name="rac"/>
        </item>
        <item id="rbc_l-f" label="Rh3 4 Close">
          <exec site="mfp" name="rbc"/>
        </item>
      </unit>
    </group>
  </macro>
</mdb>
